

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Quick introduction to generating counterfactual explanations using DiCE &mdash; Multi-obj CF 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generating Diverse Counterfactual Explanations without accessing training data" href="DiCE_with_private_data.html" />
    <link rel="prev" title="&lt;no title&gt;" href="nb_index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Multi-obj CF
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Multi-objective Optimization for Counterfactual Explanation with Structural Causal Model</a></li>
</ul>
<p class="caption"><span class="caption-text">Notebooks:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick introduction to generating counterfactual explanations using DiCE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Loading-dataset">Loading dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Loading-the-ML-model">Loading the ML model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Generate-diverse-counterfactuals">Generate diverse counterfactuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Working-with-PyTorch">Working with PyTorch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DiCE_with_private_data.html">Generating Diverse Counterfactual Explanations without accessing training data</a></li>
<li class="toctree-l1"><a class="reference internal" href="DiCE_with_advanced_options.html">Advanced options to customize Counterfactual Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DiCE_getting_started_feasible.html">Generate feasible counterfactual explanations using a VAE</a></li>
<li class="toctree-l1"><a class="reference internal" href="DiCE_getting_started_feasible.html#Adding-feasibility-constraints">Adding feasibility constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualize validity</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualize-IM1-and-IM2">Visualize IM1 and IM2</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualize-proximity">Visualize proximity</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualized-all">Visualized all</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualize-with-different-number-of-samples">Visualize with different number of samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualize-with-different-number-of-instances">Visualize with different number of instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualize-with-different-size">Visualize with different size</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html#Visualize-different-sizes-with-confidence">Visualize different sizes with confidence</a></li>
</ul>
<p class="caption"><span class="caption-text">Package:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../distance.html">distance module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation_func.html">evaluation_func module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dfencoder.html">dfencoder package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prototype.html">prototype module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">utils package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Multi-obj CF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="nb_index.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Quick introduction to generating counterfactual explanations using DiCE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/DiCE_getting_started.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Quick-introduction-to-generating-counterfactual-explanations-using-DiCE">
<h1>Quick introduction to generating counterfactual explanations using DiCE<a class="headerlink" href="#Quick-introduction-to-generating-counterfactual-explanations-using-DiCE" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># import DiCE
PATH = &quot;/data/trduong/counterfactual-explanation-research.git/DiCE&quot;

import sys
sys.path.insert(1, PATH)



import dice_ml
from dice_ml.utils import helpers # helper functions

# supress deprecation warnings from TF
import tensorflow as tf
tf.compat.v1.logging.set_verbosity(tf.compat.v1.logging.ERROR)
</pre></div>
</div>
</div>
<p>DiCE requires two inputs: a training dataset and a pre-trained ML model. It can also work without access to the full dataset (see this <a class="reference internal" href="DiCE_with_private_data.html"><span class="doc">notebook</span></a> for advanced examples).</p>
<div class="section" id="Loading-dataset">
<h2>Loading dataset<a class="headerlink" href="#Loading-dataset" title="Permalink to this headline">¶</a></h2>
<p>We use the “adult” income dataset from UCI Machine Learning Repository (<a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/adult">https://archive.ics.uci.edu/ml/datasets/adult</a>). For demonstration purposes, we transform the data as described in <strong>dice_ml.utils.helpers</strong> module.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dataset = helpers.load_adult_income_dataset()
</pre></div>
</div>
</div>
<p>This dataset has 8 features. The outcome is income which is binarized to 0 (low-income, &lt;=50K) or 1 (high-income, &gt;50K).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>dataset.head()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>Government</td>
      <td>Bachelors</td>
      <td>Single</td>
      <td>White-Collar</td>
      <td>White</td>
      <td>Male</td>
      <td>40</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Self-Employed</td>
      <td>Bachelors</td>
      <td>Married</td>
      <td>White-Collar</td>
      <td>White</td>
      <td>Male</td>
      <td>13</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Divorced</td>
      <td>Blue-Collar</td>
      <td>White</td>
      <td>Male</td>
      <td>40</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>Private</td>
      <td>School</td>
      <td>Married</td>
      <td>Blue-Collar</td>
      <td>Other</td>
      <td>Male</td>
      <td>40</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Married</td>
      <td>Professional</td>
      <td>Other</td>
      <td>Female</td>
      <td>40</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># description of transformed features
adult_info = helpers.get_adult_data_info()
adult_info
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;age&#39;: &#39;age&#39;,
 &#39;workclass&#39;: &#39;type of industry (Government, Other/Unknown, Private, Self-Employed)&#39;,
 &#39;education&#39;: &#39;education level (Assoc, Bachelors, Doctorate, HS-grad, Masters, Prof-school, School, Some-college)&#39;,
 &#39;marital_status&#39;: &#39;marital status (Divorced, Married, Separated, Single, Widowed)&#39;,
 &#39;occupation&#39;: &#39;occupation (Blue-Collar, Other/Unknown, Professional, Sales, Service, White-Collar)&#39;,
 &#39;race&#39;: &#39;white or other race?&#39;,
 &#39;gender&#39;: &#39;male or female?&#39;,
 &#39;hours_per_week&#39;: &#39;total work hours per week&#39;,
 &#39;income&#39;: &#39;0 (&lt;=50K) vs 1 (&gt;50K)&#39;}
</pre></div></div>
</div>
<p>Given this dataset, we construct a data object for DiCE. Since continuous and discrete features have different ways of perturbation, we need to specify the names of the continuous features. DiCE also requires the name of the output variable that the ML model will predict.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>d = dice_ml.Data(dataframe=dataset, continuous_features=[&#39;age&#39;, &#39;hours_per_week&#39;], outcome_name=&#39;income&#39;)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Loading-the-ML-model">
<h2>Loading the ML model<a class="headerlink" href="#Loading-the-ML-model" title="Permalink to this headline">¶</a></h2>
<p>Below, we use a pre-trained ML model which produces high accuracy comparable to other baselines. For convenience, we include the sample trained model with the DiCE package.</p>
<p>The variable <em>backend</em> below indicates the implementation type of DiCE we want to use. We use TensorFlow 1.x in the notebooks with backend=‘TF1’. You can set backend to ‘TF2’ or ‘PYT’ to use DiCE with TensorFlow 2.x or with PyTorch respectively. We want to note that the time required to find counterfactuals with Tensorflow 2.x’s eager style of execution is significantly greater than that with TensorFlow 1.x’s graph execution.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>backend = &#39;PYT&#39; # TF1
ML_modelpath = helpers.get_adult_income_modelpath(backend=backend)
m = dice_ml.Model(model_path= ML_modelpath, backend=backend)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>ML_modelpath
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;/data/trduong/counterfactual-explanation-research.git/DiCE/dice_ml/utils/sample_trained_models/adult.pth&#39;
</pre></div></div>
</div>
<p>For an example of how to train your own model, check out <a class="reference internal" href="DiCE_with_advanced_options.html"><span class="doc">this</span></a> notebook.</p>
</div>
<div class="section" id="Generate-diverse-counterfactuals">
<h2>Generate diverse counterfactuals<a class="headerlink" href="#Generate-diverse-counterfactuals" title="Permalink to this headline">¶</a></h2>
<p>Based on the data object <em>d</em> and the model object <em>m</em>, we can now instantiate the DiCE class for generating explanations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># initiate DiCE
exp = dice_ml.Dice(d, m)
</pre></div>
</div>
</div>
<p>DiCE provides local explanation for the model <em>m</em> and requires an query input whose outcome needs to be explained. Below we provide a sample input whose outcome is 0 (low-income) as per the ML model object <em>m</em>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># query instance in the form of a dictionary; keys: feature name, values: feature value
query_instance = {&#39;age&#39;:22,
                  &#39;workclass&#39;:&#39;Private&#39;,
                  &#39;education&#39;:&#39;HS-grad&#39;,
                  &#39;marital_status&#39;:&#39;Single&#39;,
                  &#39;occupation&#39;:&#39;Service&#39;,
                  &#39;race&#39;: &#39;White&#39;,
                  &#39;gender&#39;:&#39;Female&#39;,
                  &#39;hours_per_week&#39;: 45}
</pre></div>
</div>
</div>
<p>Given the query input, we can now generate counterfactual explanations to show perturbed inputs from the original input where the ML model outputs class 1 (high-income).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># generate counterfactuals
dice_exp = exp.generate_counterfactuals(query_instance, total_CFs=4, desired_class=&quot;opposite&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Diverse Counterfactuals found! total time taken: 00 min 11 sec
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># visualize the results
dice_exp.visualize_as_dataframe()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Query instance (original outcome : 0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Single</td>
      <td>Service</td>
      <td>White</td>
      <td>Female</td>
      <td>45.0</td>
      <td>0.000042</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Diverse Counterfactual set (new outcome : 1)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>72.0</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married</td>
      <td>White-Collar</td>
      <td>White</td>
      <td>Female</td>
      <td>45.0</td>
      <td>0.691</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29.0</td>
      <td>Private</td>
      <td>Prof-school</td>
      <td>Married</td>
      <td>Service</td>
      <td>White</td>
      <td>Male</td>
      <td>45.0</td>
      <td>0.954</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52.0</td>
      <td>Private</td>
      <td>Doctorate</td>
      <td>Married</td>
      <td>Service</td>
      <td>White</td>
      <td>Female</td>
      <td>45.0</td>
      <td>0.971</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.0</td>
      <td>Private</td>
      <td>Masters</td>
      <td>Married</td>
      <td>Service</td>
      <td>White</td>
      <td>Female</td>
      <td>73.0</td>
      <td>0.971</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In case, if you would like to visualize only the changes made to the query instance, you can set the parameter <em>show_only_changes=True</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># highlight only the changes
dice_exp.visualize_as_dataframe(show_only_changes=True)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Query instance (original outcome : 0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Single</td>
      <td>Service</td>
      <td>White</td>
      <td>Female</td>
      <td>45.0</td>
      <td>0.000042</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Diverse Counterfactual set (new outcome : 1)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>72.0</td>
      <td>-</td>
      <td>-</td>
      <td>Married</td>
      <td>White-Collar</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>0.691</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29.0</td>
      <td>-</td>
      <td>Prof-school</td>
      <td>Married</td>
      <td>-</td>
      <td>-</td>
      <td>Male</td>
      <td>-</td>
      <td>0.954</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52.0</td>
      <td>-</td>
      <td>Doctorate</td>
      <td>Married</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>0.971</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.0</td>
      <td>-</td>
      <td>Masters</td>
      <td>Married</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>73.0</td>
      <td>0.971</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>That’s it! You can try generating counterfactual explanations for other examples using the same code. You can also try out a use-case for sensitive data in <a class="reference internal" href="DiCE_with_private_data.html"><span class="doc">this</span></a> notebook.</p>
<p>If you are curious about changing the number of explanations showns, feasibility of the explanations, or how to weigh different features for perturbing, check out how to change DiCE’s behavior in this <a class="reference internal" href="DiCE_with_advanced_options.html"><span class="doc">advanced notebook</span></a>.</p>
<p>The counterfactuals generated above are slightly different from those shown in <a class="reference external" href="https://arxiv.org/pdf/1905.07697.pdf">our paper</a>, where the loss convergence condition was made more conservative for rigorous experimentation. To replicate the results in the paper, add an argument <em>loss_converge_maxiter=2</em> (the default value is 1) in the <em>exp.generate_counterfactuals()</em> method above. For more info, see <em>generate_counterfactuals()</em> method in
<a class="reference external" href="https://github.com/interpretml/DiCE/blob/master/dice_ml/dice_interfaces/dice_tensorflow1.py">dice_ml.dice_interfaces.dice_tensorflow.py</a>.</p>
</div>
<div class="section" id="Working-with-PyTorch">
<h2>Working with PyTorch<a class="headerlink" href="#Working-with-PyTorch" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>try:
    import torch
    print(&#39;PyTorch installed.&#39;)
except ImportError as e:
    print(&quot;Import Error!&quot;, e.name, &quot;not found.. Please install from https://pytorch.org/&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyTorch installed.
</pre></div></div>
</div>
<p>Just change the backend variable to ‘PYT’ to use DiCE with PyTorch. Below, we use a pre-trained ML model in PyTorch which produces high accuracy comparable to other baselines. For convenience, we include the sample trained model with the DiCE package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>backend = &#39;PYT&#39;
ML_modelpath = helpers.get_adult_income_modelpath(backend=backend)
m = dice_ml.Model(model_path= ML_modelpath, backend=backend)
</pre></div>
</div>
</div>
<p>Instantiate the DiCE class with the new PyTorch model object <em>m</em>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>exp = dice_ml.Dice(d, m)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># query instance in the form of a dictionary; keys: feature name, values: feature value
query_instance = {&#39;age&#39;:22,
                  &#39;workclass&#39;:&#39;Private&#39;,
                  &#39;education&#39;:&#39;HS-grad&#39;,
                  &#39;marital_status&#39;:&#39;Single&#39;,
                  &#39;occupation&#39;:&#39;Service&#39;,
                  &#39;race&#39;: &#39;White&#39;,
                  &#39;gender&#39;:&#39;Female&#39;,
                  &#39;hours_per_week&#39;: 45}
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># generate counterfactuals
dice_exp = exp.generate_counterfactuals(query_instance, total_CFs=4, desired_class=&quot;opposite&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Loss type hinge_loss
Diverse Counterfactuals found! total time taken: 00 min 11 sec
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># highlight only the changes
dice_exp.visualize_as_dataframe(show_only_changes=True)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Query instance (original outcome : 0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Single</td>
      <td>Service</td>
      <td>White</td>
      <td>Female</td>
      <td>45.0</td>
      <td>0.000042</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Diverse Counterfactual set (new outcome : 1)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>race</th>
      <th>gender</th>
      <th>hours_per_week</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>72.0</td>
      <td>-</td>
      <td>-</td>
      <td>Married</td>
      <td>White-Collar</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>0.691</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29.0</td>
      <td>-</td>
      <td>Prof-school</td>
      <td>Married</td>
      <td>-</td>
      <td>-</td>
      <td>Male</td>
      <td>-</td>
      <td>0.954</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52.0</td>
      <td>-</td>
      <td>Doctorate</td>
      <td>Married</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>0.971</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47.0</td>
      <td>-</td>
      <td>Masters</td>
      <td>Married</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>73.0</td>
      <td>0.971</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="DiCE_with_private_data.html" class="btn btn-neutral float-right" title="Generating Diverse Counterfactual Explanations without accessing training data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="nb_index.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021 Dung Duong, Qian Li, Guandong Xu.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>